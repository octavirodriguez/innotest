

name: Playwright Tests
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
jobs:
  test:
    # Máximo tiempo de espera antes de que el job se cancele
    timeout-minutes: 60
    # Define que el job se ejecutará en el último sistema operativo Ubuntu (Linux)
    runs-on: ubuntu-latest
    steps:
    # 1. Checkout the repository code
    - uses: actions/checkout@v4
    
    # 2. Set up Node.js environment
    - uses: actions/setup-node@v4
      with:
        # Usa la versión LTS (Long Term Support) para estabilidad
        node-version: lts/*
        
    # 3. Install project dependencies (from package-lock.json)
    - name: Install dependencies
      run: npm ci
      
    # 4. Install Playwright browsers and their dependencies
    - name: Install Playwright Browsers
      # Instala los binarios de Chromium, Firefox, y WebKit
      run: npx playwright install --with-deps
      
    # 5. Run the actual tests
    - name: Run Playwright tests
      # Ejecuta el comando principal de prueba
      run: npx playwright test
      
    # 6. Upload the test results report
    - uses: actions/upload-artifact@v4
      # Solo si el job no fue cancelado
      if: ${{ !cancelled() }}
      with:
        # Nombre del archivo zip subido
        name: playwright-report
        # Directorio donde Playwright guarda el reporte HTML
        path: playwright-report/
        # Mantiene el artefacto disponible por 30 días
        retention-days: 30
